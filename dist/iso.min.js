"use strict";var _prototypeProperties=function(e,t,r){if(t)Object.defineProperties(e,t);if(r)Object.defineProperties(e.prototype,r)};var _classCallCheck=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var escapeTextForBrowser=require("escape-html");var each=function(e,t){return Array.prototype.forEach.call(e,t)};var parse=function(e,t){return JSON.parse(e.getAttribute(t))};var Iso=function(){function e(){_classCallCheck(this,e);this.html=[];this.data=[]}_prototypeProperties(e,{render:{value:function t(r){var a=arguments[1]===undefined?{}:arguments[1];var n=arguments[2]===undefined?{}:arguments[2];return(new e).add(r,a,n).render()},writable:true,configurable:true},bootstrap:{value:function r(e){if(!e){return}var t=document.querySelectorAll(".___iso-html___");var r=document.querySelectorAll(".___iso-state___");var a={};each(r,function(e){var t=parse(e,"data-meta");var r=parse(e,"data-state");a[e.getAttribute("data-key")]={meta:t,state:r}});each(t,function(t){var r=t.getAttribute("data-key");if(!a[r]){return}var n=a[r];var u=n.meta;var i=n.state;e(i,u,t)});a=null},writable:true,configurable:true},on:{value:function a(t,r,n){e.bootstrap(function(e,a,u){if(a[t]&&a[t]===r){n(e,a,u)}})},writable:true,configurable:true}},{add:{value:function n(e){var t=arguments[1]===undefined?{}:arguments[1];var r=arguments[2]===undefined?{}:arguments[2];var a=escapeTextForBrowser(JSON.stringify(t));var n=escapeTextForBrowser(JSON.stringify(r));this.html.push(e);this.data.push({state:a,meta:n});return this},writable:true,configurable:true},render:{value:function u(){var e=this.html.reduce(function(e,t,r){return e+('<div class="___iso-html___" data-key="'+r+'">'+t+"</div>")},"");var t=this.data.reduce(function(e,t,r){var a=t.state;var n=t.meta;return e+('<div class="___iso-state___" data-key="'+r+'" data-meta="'+n+'" data-state="'+a+'"></div>')},"");return"\n"+e+"\n"+t+"\n"},writable:true,configurable:true}});return e}();module.exports=Iso;